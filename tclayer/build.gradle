plugins {
    id "com.github.johnrengelman.shadow" version "7.1.2"
}

base {
    archivesName = project.archives_base_name
}

version = "${project.mod_version}+${project.layer_version}+${rootProject.minecraft_base_version}"
group = project.maven_group

architectury {
    platformSetupLoomIde()
    fabric()
}

repositories {
    maven { url = "https://mvn.devos.one/snapshots/" }
    maven { url = 'https://maven.ladysnake.org/releases' }
    maven { url = "https://api.modrinth.com/maven" }
    maven { url = "https://maven.wispforest.io/releases" }
    maven { url = 'https://oss.sonatype.org/content/repositories/snapshots' }
    maven { url = "https://maven.shedaniel.me/" }
    maven { url = "https://maven.terraformersmc.com/" }
    mavenLocal()
}

//evaluationDependsOn(':common')
//evaluationDependsOn(':fabric')

dependencies {
    modImplementation "net.fabricmc:fabric-loader:${rootProject.fabric_loader_version}"
    modApi "net.fabricmc.fabric-api:fabric-api:${rootProject.fabric_api_version}"

    developmentFabric implementation(project(path: ":common", configuration: "namedElements"))
    localRuntime(project(path: ":fabric", configuration: "namedElements"))

    modImplementation("me.shedaniel.cloth:cloth-config:${rootProject.cloth_version}")

    modLocalRuntime("net.minecraftforge:eventbus:6.0.5")

    modLocalRuntime("com.terraformersmc:modmenu:${rootProject.modmenu_version}")

    modLocalRuntime("maven.modrinth:ok-boomer:0.1.3+1.20")
    modLocalRuntime("io.wispforest:owo-lib:0.11.2+1.20")
    modLocalRuntime("io.wispforest:gadget:0.2.2+1.20")

    include modImplementation("dev.onyxstudios.cardinal-components-api:cardinal-components-base:5.2.2")
    include modImplementation("dev.onyxstudios.cardinal-components-api:cardinal-components-entity:5.2.2")

    modCompileOnly("maven.modrinth:sophisticated-backpacks-(unoffical-fabric-port):3.19.5+mc1.20.1-build.76")
    modCompileOnly("maven.modrinth:sophisticated-core-(unofficial-fabric-port):0.5.109+mc1.20.1-build.76")

//    modCompileOnly ("maven.modrinth:things:0.3.3+1.20.3") {
//        exclude group: "dev.emi"
//        exclude group: "com.terraformersmc"
//    }

//    modLocalRuntime("maven.modrinth:things:0.3.3+1.20.3")
//    modLocalRuntime("maven.modrinth:lavender:0.1.2+1.20.3")
}

processResources {
    inputs.property "version", project.mod_version
    inputs.property "layer_version", project.layer_version

    filesMatching("fabric.mod.json") {
        expand "version": project.mod_version,
                "layer_version": project.layer_version
    }
}

loom {}

publishing {
    publications {
        mavenFabric(MavenPublication) {
            artifactId = "${rootProject.archives_base_name}-${project.name}"
            from components.java
        }
    }
    repositories {}
}